#ifndef MAINWINDOW_H
#define MAINWINDOW_H
#include <QMainWindow>
#include <QVector>
#include <QOpenGLWidget>
#include "qcustomplot.h"
#include <ActiveQt>
#include <QOpenGLWidget>

QT_BEGIN_NAMESPACE
namespace Ui {
class MainWindow;
}
QT_END_NAMESPACE

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    MainWindow(QWidget *parent = nullptr);
    ~MainWindow();
    void setupPlot();

    void on_pushButton_3_clicked();
    void setupS11();
    void setupS12();
    void setupS21();
    void setupS22();
    void setupVNA();


private slots:
    void horzScrollBarChanged(int value);
    void vertScrollBarChanged(int value);
    void xAxisChanged(QCPRange range);
    void yAxisChanged(QCPRange range);
    void on_pushButton_clicked();


private:
    Ui::MainWindow *ui;
    QAxObject *pNWA = new QAxObject("S2VNA.Application");
    int count;
    QVector <double> x,y,Real, yS11,yS12,yS21,yS22;
    double xBegin, xEnd, h, X, min, max, minY, maxY;
    QVector <double> y1={-0.0680906, -0.0170399, -0.0976468, -0.204449, -0.255154, -0.197296, -0.201056, -0.243592, -0.290356, -0.305114, -0.293264, -0.279805, -0.312385, -0.380251, -0.394438, -0.341255, -0.321905, -0.402389, -0.465612, -0.43209, -0.377446, -0.408852, -0.475812, -0.488912, -0.461506, -0.460252, -0.469736, -0.485386, -0.519991, -0.544806, -0.513864, -0.476283, -0.526167, -0.610233, -0.588186, -0.505582, -0.513474, -0.617661, -0.646962, -0.580096, -0.543491, -0.592006, -0.641224, -0.636531, -0.626277, -0.62422, -0.615929, -0.631107, -0.680922, -0.693912, -0.636036, -0.604507, -0.683029, -0.761539, -0.709619, -0.618804, -0.650212, -0.759426, -0.773976, -0.69453, -0.671398, -0.729793, -0.769076, -0.754871, -0.743275, -0.743943, -0.732475, -0.758868, -0.825737, -0.828085, -0.739641, -0.718452, -0.826175, -0.907857, -0.820081, -0.733886, -0.810052, -0.922886, -0.90355, -0.825308, -0.822386, -0.879686, -0.903708, -0.899656, -0.892437, -0.860485, -0.837606, -0.888195, -0.972171, -0.939327, -0.824004, -0.832118, -0.973057, -1.02441, -0.904277, -0.825373, -0.918946, -1.03253, -1.00358, -0.915656, -0.9053, -0.964715, -1.00561, -1.02092, -0.998158, -0.93628, -0.917052, -1.01808, -1.11965, -1.04421, -0.883399, -0.917406, -1.11412, -1.17109, -0.997415, -0.885965, -1.00372, -1.15148, -1.12075, -1.01009, -0.965309, -1.0144, -1.09141, -1.15542, -1.11966, -0.969913, -0.935178, -1.0989, -1.25201, -1.12774, -0.898024, -0.933842, -1.21329, -1.2854, -1.0929, -0.948314, -1.07574, -1.24656, -1.25849, -1.16284, -1.06312, -1.05379, -1.175, -1.33987, -1.32177, -1.06876, -0.974587, -1.23598, -1.47341, -1.30768, -0.998418, -1.01724, -1.33845, -1.44904, -1.2756, -1.05834, -1.12503, -1.29532, -1.41887, -1.40735, -1.23197, -1.09354, -1.25797, -1.5342, -1.52152, -1.18234, -1.01816, -1.32744, -1.64096, -1.49801, -1.15294, -1.08988, -1.39724, -1.56177, -1.43642, -1.22865, -1.14548, -1.28249, -1.50024, -1.56228, -1.31446, -1.04531, -1.18629, -1.59411, -1.63714, -1.25258, -0.97115, -1.26968, -1.66132, -1.58521, -1.24645, -1.08476, -1.32104, -1.58481, -1.58083, -1.35975, -1.14135, -1.22163, -1.54147, -1.70688, -1.45412, -1.06491, -1.14747, -1.67833, -1.82264, -1.42674, -1.06666, -1.29752, -1.7765, -1.77224, -1.45256, -1.2305, -1.36959, -1.66142, -1.7944, -1.64338, -1.3087, -1.23405, -1.66778, -1.99669, -1.71464, -1.21307, -1.22498, -1.83489, -2.05164, -1.64956, -1.26354, -1.39486, -1.85904, -1.95285, -1.7286, -1.44692, -1.40669, -1.70216, -2.02583, -1.90654, -1.39024, -1.19561, -1.71909, -2.17942, -1.86442, -1.32913, -1.26955, -1.83429, -2.1122, -1.81374, -1.42754, -1.37961, -1.74985, -2.05261, -1.96453, -1.59325, -1.34053, -1.64027, -2.17393, -2.13556, -1.588, -1.2704, -1.71879, -2.32409, -2.09692, -1.54294, -1.32967, -1.76656, -2.17322, -2.06763, -1.67216, -1.4498, -1.65887, -2.12459, -2.24205, -1.82694, -1.37044, -1.54915, -2.21033, -2.35012, -1.76036, -1.31799, -1.60306, -2.26621, -2.25748, -1.77092, -1.44544, -1.67841, -2.13852, -2.27093, -1.96732, -1.54347, -1.5342, -2.0219, -2.41243, -2.0702, -1.47093, -1.45944, -2.16724, -2.52986, -2.05113, -1.50797, -1.62187, -2.20738, -2.41361, -2.08237, -1.67928, -1.63659, -2.01517, -2.38458, -2.29041, -1.72392, -1.4838, -1.92959, -2.52054, -2.32811, -1.67215, -1.5081, -2.12263, -2.57375, -2.29837, -1.77522, -1.72413, -2.13858, -2.44143, -2.36984, -1.99374, -1.74123, -1.95311, -2.42041, -2.51745, -1.98093, -1.56935, -1.92257, -2.55779, -2.50257, -1.89945, -1.65513, -2.09131, -2.49071, -2.36383, -2.00938, -1.83998, -2.0554, -2.33204, -2.48452, -2.23303, -1.84926, -1.90316, -2.42047, -2.65738, -2.24207, -1.76026, -2.01932, -2.58471, -2.61462, -2.14506, -1.8839, -2.20442, -2.5195, -2.50918, -2.34335, -2.15161, -2.14892, -2.36416, -2.65833, -2.56135, -2.08595, -1.9862, -2.51743, -2.87766, -2.51336, -2.00434, -2.20999, -2.73486, -2.73649, -2.44263, -2.27942, -2.42988, -2.52615, -2.64464, -2.72818, -2.5521, -2.23866, -2.45378, -2.91276, -2.92667, -2.33937, -2.21467, -2.77371, -3.0813, -2.73381, -2.39048, -2.59207, -2.90088, -2.86442, -2.82426, -2.82945, -2.74735, -2.73202, -2.99669, -3.22526, -2.9671, -2.5781, -2.86877, -3.37412, -3.32859, -2.8434, -2.82283, -3.36918, -3.46964, -3.21046, -3.10558, -3.3797, -3.42607, -3.39305, -3.48409, -3.61233, -3.38313, -3.38222, -3.74942, -4.01401, -3.64245, -3.38424, -3.87094, -4.35437, -4.02669, -3.66483, -3.93465, -4.53701, -4.38061, -4.13782, -4.26075, -4.63294, -4.61478, -4.63362, -4.88818, -4.90916, -4.75334, -4.97139, -5.55306, -5.47736, -5.02984, -5.09363, -6.03957, -6.23486, -5.75924, -5.5989, -6.28639, -6.91764, -6.68185, -6.48969, -6.74844, -7.12604, -7.4523, -7.65978, -7.76269, -7.68267, -7.65193, -8.17898, -8.88848, -8.66827, -8.05206, -8.12152, -9.0233, -9.60162, -8.75064, -8.04118, -8.25452, -8.9069, -8.66561, -8.1082, -7.94938, -8.00878, -7.87462, -7.87655, -8.11506, -7.87587, -7.1315, -6.96686, -7.75089, -8.10836, -7.18795, -6.53309, -6.85787, -7.50554, -7.24403, -6.76751, -6.64143, -6.77571, -6.68204, -6.8886, -7.21064, -6.85834, -6.21067, -6.40244, -7.2116, -7.29709, -6.43981, -6.11396, -6.72444, -7.25018, -6.94256, -6.54875};
    QVector <double> y2={};
    char type;
};
#endif // MAINWINDOW_H
